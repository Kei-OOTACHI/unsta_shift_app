# シフト自動化システム 利用マニュアル

## 1. はじめに

### ツールの目的と概要
このシステムは、Googleスプレッドシートを使用してシフト管理を自動化し、効率的なスケジュール作成とメンバー情報管理を支援するRPAツールです。

### 対象業務の説明
- **シフト表作成業務**: 時間軸設定と行複製による効率的なシフト表生成
- **メンバー情報管理業務**: メンバーデータの一括更新と複数シートへの同期
- **ガントチャート作成業務**: 部署別ガントチャートの自動生成
- **データ入力業務**: カスタムポップアップによる直感的なデータ入力

### 使用上の注意点
- 大量データ処理時は完了まで他の操作を控えてください
- 複製操作は元に戻せないため、事前にバックアップを推奨します
- 同時に複数のユーザーが操作する場合は、競合を避けるため調整してください
- Google Apps Scriptの実行時間制限（6分）があります

## 2. 操作環境

### 対応OSや必要なソフトウェア
- **対応OS**: Windows、macOS、Linux（Webブラウザが動作する環境）
- **必要なソフトウェア**: 
  - Google Chrome（推奨）、Firefox、Safari、Microsoft Edge
  - インターネット接続

### 推奨されるPCスペック
- **メモリ**: 4GB以上
- **ブラウザ**: 最新版のWebブラウザ
- **画面解像度**: 1024×768以上

### ネットワーク要件
- **インターネット接続**: 必須
- **Google Workspace**: アクセス権限必須
- **ファイアウォール**: Google Apps Script実行許可
- **必要な権限**:
  - Googleアカウント（編集権限付き）
  - 対象スプレッドシートへのアクセス権限
  - Google Apps Scriptの実行権限

## 3. 操作手順

### 起動方法
1. Webブラウザを起動
2. Googleアカウントにログイン
3. 対象のGoogleスプレッドシートを開く
4. メニューバーに「🤖自動化ツール」が表示されることを確認

### ログイン手順
1. **Googleアカウントログイン**
   - ブラウザでGoogle.comにアクセス
   - 「ログイン」をクリック
   - メールアドレスとパスワードを入力
   - 必要に応じて2段階認証を完了

2. **スプレッドシートアクセス**
   - Google Driveまたは直接URLでスプレッドシートにアクセス
   - 編集権限があることを確認

### 具体的な操作手順（スクリーンショット付き）

#### メニュー構成
システムには以下の4つのメインメニューがあります：

**🤖自動化ツール**
- **FMシート作成**
  - 時間軸を設定
  - 行セットを複製
- **ガントチャート作成**
  - 局ごとのガントチャートシートを作成
- **メンバー管理**
  - メンバー情報を全シートに更新
- **共通機能**
  - その他の共通操作

### 処理結果の確認方法
1. **実行完了メッセージ**: 処理完了時にポップアップで結果が表示されます
2. **更新されたシート**: 対象シートが自動的に更新されます
3. **ログ確認**: 必要に応じてGoogle Apps Scriptのログで詳細を確認できます

#### 4.1 FMシート作成機能

**時間軸を設定**
1. 時間軸を挿入したいセルを選択
2. メニュー「🤖自動化ツール」→「FMシート作成」→「時間軸を設定」をクリック
3. ポップアップダイアログで以下を入力：
   - **開始時刻**: シフト開始時刻（例：09:00）
   - **終了時刻**: シフト終了時刻（例：18:00）
   - **時間間隔**: 時間の刻み幅（分単位、例：30）
4. 「送信」ボタンをクリック
5. **結果**: 指定した時間軸が横方向に自動生成されます

**行セットを複製**
1. 複製したい行範囲を選択
2. メニュー「🤖自動化ツール」→「FMシート作成」→「行セットを複製」をクリック
3. ポップアップダイアログで複製回数を入力
4. 「送信」ボタンをクリック
5. **結果**: 選択した行が指定回数分、書式付きで複製されます

#### 4.2 ガントチャート作成機能

**局ごとのガントチャートシートを作成**
1. ガントチャートのヘッダー範囲を選択
2. メニュー「🤖自動化ツール」→「ガントチャート作成」→「局ごとのガントチャートシートを作成」をクリック
3. ダイアログで以下を入力：
   - **対象スプレッドシートのURL**: 作成先のスプレッドシートURL
   - **一人あたりの日数**: 各メンバーの日数設定
   - **メンバー間に空白行を挿入する**: チェックボックス
4. 「送信」ボタンをクリック
5. **結果**: 部署別にガントチャートシートが自動作成されます

#### 4.3 メンバー管理機能

**メンバー情報を全シートに更新**
1. メニュー「🤖自動化ツール」→「メンバー管理」→「メンバー情報を全シートに更新」をクリック
2. 処理完了まで待機
3. **結果**: 
   - 更新されたシート名が表示されます
   - 各シートのメンバー情報が最新データに同期されます

#### 「スプレッドシートURLまたはヘッダー範囲が設定されていません」
**原因**: 初期設定が完了していない
**対処法**: 先にガントチャートテンプレート複製を実行してください

#### 「権限がありません」
**原因**: スプレッドシートへのアクセス権限不足
**対処法**: 管理者に編集権限の付与を依頼してください

#### 「更新されたシートはありません」
**原因**: 対象となるシートが存在しないか、データ形式が不正
**対処法**: 
1. ガントチャートシートが存在することを確認
2. ヘッダー行の形式を確認
3. メンバーデータシートの形式を確認

#### ダイアログが表示されない
**原因**: ポップアップブロックまたはスクリプト実行権限不足
**対処法**: 
1. ブラウザのポップアップブロックを解除
2. Google Apps Scriptの実行を許可

#### 「無効な時間形式」エラー
**原因**: 時間入力形式が不正
**対処法**: 時間は「HH:MM」形式（例：09:00、18:30）で入力してください

### サポートへの連絡方法
技術的な問題や機能追加の要望については、以下にお問い合わせください：
- **システム管理者**: [連絡先を記載]
- **IT部門**: [連絡先を記載]
- **緊急時**: [緊急連絡先を記載]

## 5. FAQ

### よくある質問と回答

#### Q: 時間軸設定で「無効な時間形式」エラーが出る
A: 時間は「HH:MM」形式（例：09:00、18:30）で入力してください。

#### Q: 行複製で書式が崩れる
A: 元の行の書式設定を確認し、結合セルや条件付き書式が正しく設定されているか確認してください。

#### Q: メンバー情報更新が反映されない
A: メンバーデータシートのヘッダー行と、ガントチャートシートのヘッダー行が一致しているか確認してください。

#### Q: 処理が途中で止まる
A: Google Apps Scriptの実行時間制限に達した可能性があります。データ量を減らすか、管理者に相談してください。

#### Q: ガントチャート作成時に「必須ヘッダーが見つかりません」エラーが出る
A: 「メンバー情報」シートに必要なヘッダー（dept、email、memberIdなど）が存在することを確認してください。

#### Q: 複数のユーザーが同時に操作できますか？
A: 同時操作は競合の原因となるため、操作前に他のユーザーと調整することを推奨します。

## 6. 付録

### 用語集
- **GAS**: Google Apps Scriptの略称
- **ガントチャート**: プロジェクトの進行状況を時系列で表示するチャート
- **メンバーDateID**: メンバーIDと日付を組み合わせた一意識別子
- **A1記法**: スプレッドシートのセル範囲を表す記法（例：A1:C10）
- **スクリプトプロパティ**: GASで設定値を保存する仕組み

### 関連資料へのリンク
- [Google Apps Script公式ドキュメント](https://developers.google.com/apps-script)
- [Google スプレッドシート ヘルプ](https://support.google.com/docs/topic/9054603)
- [システム設計書]: [内部リンクを記載]
- [操作動画]: [動画リンクを記載]

---

**最終更新日**: 2024年12月
**バージョン**: 1.0 